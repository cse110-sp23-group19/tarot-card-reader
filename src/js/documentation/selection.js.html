<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: selection.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: selection.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>import { cards } from "./tarotCards.js";

/**
 * An array of indices referencing the shuffled cards displayed on screen
 * @type {number[]}
 */
let indexes = [];

/**
 * An array of selected fortuneCard elements
 * @type {HTMLElement[]}
 */
let selectedCards = [];

const layout = document.getElementsByClassName("cards-to-select")[0];

/**
 * Shuffles the deck and displays 12 cards for selection
 */
function shuffleDeck() {
	console.log("hit");
	selectedCards = [];
	indexes = [];
	while (indexes.length &lt; 12) {
		const randomIndex = Math.floor(Math.random() * 78);
		if (!indexes.includes(randomIndex)) {
			indexes.push(randomIndex);
		}
	}
	layout.innerHTML = "";
	displayShuffledCards();
}

/**
 * displays each of the 12 shuffled cards to the display
 */
function displayShuffledCards() {
	indexes.forEach((index) => {
		// TODO: instead of displaying the actual fortuneCard, display the back of the card
		const newBackfaceCard = document.createElement("backface-card");
		newBackfaceCard.index = index;

		//const newCard = document.createElement("fortune-card");
		//newCard.data = cards.tarot[index];
		layout.appendChild(newBackfaceCard);
		addCardClickListener(newBackfaceCard);
	});
}

/**
 * sets up an event listener for each fortuneCard
 * @param {HTMLElement} card
 */
function addCardClickListener(card) {
	card.addEventListener("click", function () {
		if (selectedCards.includes(card.index)) {
			alert("This card has already been selected");
			return;
		}
		if (selectedCards.length &lt; 3) {
			selectedCards.push(card.index);
			if (selectedCards.length === 3) {
				selectedCards.forEach((elem) => {
					console.log(elem);
				});
			}
		} else {
			alert("you have selected 3 cards already");
		}
	});
}

/**
 * sets up an event listener for the shuffle button, shuffles the dislay on click
 */
document.querySelector(".shuffle-layout").addEventListener("click", () => {
	shuffleDeck();
});

/**
 * sets up an event listener for the submit button, displays the 3 selected cards
 */
document.querySelector(".submit-selection").addEventListener("click", function () {
	if (selectedCards.length &lt; 3) {
		alert("you do not have 3 cards selected");
		return;
	}
	displayFortunePage();
});

/**
 * removes the selection page, and makes the selected cards visible to user
 */
function displayFortunePage() {
	const fortuneReadingsDisplay = document.querySelector(".display-fortunes");
	const selectionPageElement = document.querySelector("#selection-page");
	const fortunePageElement = document.querySelector("#fortune-page");

	selectionPageElement.remove();
	fortunePageElement.style.visibility = "visible";

	selectedCards.forEach((cardIndex) => {
		const newCard = document.createElement("fortune-card");
		newCard.data = cards.tarot[cardIndex];
		fortuneReadingsDisplay.appendChild(newCard);
	});
}
/**
 * A class to represent the back of the cards
 */
class backfaceCard extends HTMLElement {
	/**
	 * @constructor
	 */
	constructor() {
		super();
		this._index = null;
		this.attachShadow({ mode: "open" });
	}
	connectedCallback() {
		this.shadowRoot.innerHTML = `
		&lt;style>
			div {
				width: 200px;
				height: 300px;
			}

			img {
				width: 100%;
				height: 100%
			}
		&lt;/style>
		&lt;div>
			&lt;img src = "/src/assets/card-scans/backface-card.jpg">
		&lt;/div>`;
	}
	get index() {
		return this._index;
	}

	set index(index) {
		this._index = index;
	}
}

/**
 * Fortune card custom HTML element
 */
class fortuneCard extends HTMLElement {
	constructor() {
		super();
		this.attachShadow({ mode: "open" });
		const articleElement = document.createElement("article");
		const styleElement = document.createElement("style");
		styleElement.textContent = `
      * {
        font-family: sans-serif;
        margin: 0;
        padding: 0px;
        // align-items: center;
        // display: grid;
      }
    
      a {
        text-decoration: none;
      }
    
      a:hover {
        text-decoration: underline;
      }
      // div{
      //   background-color:  aqua;
      // }
    
      article {
        align-items: center;
        border: 1px solid rgb(223, 225, 229);
        border-radius: 8px;
        display: grid;
        grid-template-rows: 118px 56px 14px 18px 15px 36px;
        height: auto;
        row-gap: 5px;
        padding: 0 16px 16px 16px;
        width: 300px;
        background-color: #eed9c4;
        margin: 20px;
        grid-auto-flow: row;
      }
      h3{
        padding-top: 20px;
        // display: inline;
        grid-row-start: 1;


      }

      img{
        height: 200px;
        grid-row-start:2;

      }
      `;
		this.shadowRoot.appendChild(styleElement);
		this.shadowRoot.append(articleElement);
	}

	/**
	 * Called when the .data property is set on this element.
	 *
	 * For Example:
	 * let recipeCard = document.createElement('recipe-card'); // Calls constructor()
	 * recipeCard.data = { foo: 'bar' } // Calls set data({ foo: 'bar' })
	 *
	 * @param {Object} data - The data to pass into the &lt;recipe-card>, must be of the
	 *                        following format:
	 *                        {
	 *                          "imgSrc": "string",
	 *                          "imgAlt": "string",
	 *                          "titleLnk": "string",
	 *                          "titleTxt": "string",
	 *                          "organization": "string",
	 *                          "rating": number,
	 *                          "numRatings": number,
	 *                          "lengthTime": "string",
	 *                          "ingredients": "string"
	 *                        }
	 */
	set data(data) {
		// If nothing was passed in, return
		if (!data) return;
		// console.log("data", data);
		// A6. TODO - Select the &lt;article> we added to the Shadow DOM in the constructor
		const articleDOM = this.shadowRoot.querySelector("article");

		let imageName = data["img"];
		// const imageName = str[0] + numbers

		articleDOM.innerHTML = `
      &lt;div>
      &lt;h3 class="cardName">${data["name"]}&lt;/h3>
      &lt;img src = "/src/assets/card-scans/${imageName}">
      
      &lt;/div>`;
	}
}

customElements.define("backface-card", backfaceCard);
customElements.define("fortune-card", fortuneCard);

/**
 * Calls shuffleDeck on window load in order to setup the initial layout
 */
window.onload = shuffleDeck();
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="backfaceCard.html">backfaceCard</a></li><li><a href="fortuneCard.html">fortuneCard</a></li></ul><h3>Global</h3><ul><li><a href="global.html#addCardClickListener">addCardClickListener</a></li><li><a href="global.html#displayFortunePage">displayFortunePage</a></li><li><a href="global.html#displayShuffledCards">displayShuffledCards</a></li><li><a href="global.html#indexes">indexes</a></li><li><a href="global.html#selectedCards">selectedCards</a></li><li><a href="global.html#shuffleDeck">shuffleDeck</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 4.0.2</a> on Thu May 25 2023 21:45:10 GMT-0700 (Pacific Daylight Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
